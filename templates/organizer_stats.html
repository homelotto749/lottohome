<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ HOMELOTO</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f8f9fa; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 20px; border-radius: 8px; }
        h2 { border-bottom: 2px solid #4B0082; padding-bottom: 10px; }
        
        /* –°–µ—Ç–∫–∞ –±–∏–ª–µ—Ç–æ–≤ */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; margin-top: 20px; }
        .ticket-box { 
            border: 1px solid #ccc; padding: 10px; text-align: center; border-radius: 5px; font-size: 14px; position: relative;
        }
        .status-badge { position: absolute; top: 0; left: 0; padding: 2px 5px; font-size: 10px; color: white; border-radius: 4px 0 4px 0; }
        
        .st-available { background: #28a745; } /* –ó–µ–ª–µ–Ω—ã–π - –°–≤–æ–±–æ–¥–µ–Ω */
        .st-sold { background: #dc3545; border-color: #dc3545; color: #555; opacity: 0.8; } /* –ö—Ä–∞—Å–Ω—ã–π - –ü—Ä–æ–¥–∞–Ω */
        
        /* –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
        th { background: #4B0082; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <a href="/organizer" style="text-decoration: none; color: #555;">‚Üê –ù–∞–∑–∞–¥ –≤ –ø–∞–Ω–µ–ª—å</a>
        
        <!-- –ë–ª–æ–∫ 1: –°–µ—Ç–∫–∞ –±–∏–ª–µ—Ç–æ–≤ (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ç–∏—Ä–∞–∂) -->
        {% if draw_id %}
            <h2>üéü –ö–∞—Ä—Ç–∞ –±–∏–ª–µ—Ç–æ–≤ (–¢–∏—Ä–∞–∂ #{{ draw_id }})</h2>
            <div class="grid">
                {% for t in tickets %}
                    <div class="ticket-box" style="{% if t.status == 'sold' %}background:#ffecec;{% endif %}">
                        <span class="status-badge {% if t.status == 'available' %}st-available{% else %}st-sold{% endif %}">
                            {% if t.status == 'available' %}FREE{% else %}SOLD{% endif %}
                        </span>
                        <strong>#{{ t.ticket_number }}</strong><br>
                        <small>{{ t.numbers }}</small>
                        {% if t.status == 'sold' %}<br><span style="font-size:10px; color:grey;">{{ t.sold_by }}</span>{% endif %}
                    </div>
                {% endfor %}
            </div>

        <!-- –ë–ª–æ–∫ 2: –í—ã–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        {% else %}
            <h2>üìä –û—Ç—á–µ—Ç—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</h2>
            
            <h3>üë®‚Äçüíº –¢–æ–ø –ø—Ä–æ–¥–∞–≤—Ü–æ–≤</h3>
            <table>
                <thead>
                    <tr>
                        <th>Email –ø—Ä–æ–¥–∞–≤—Ü–∞</th>
                        <th>–ü—Ä–æ–¥–∞–Ω–æ –±–∏–ª–µ—Ç–æ–≤</th>
                        <th>–í—ã—Ä—É—á–∫–∞</th>
                        <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for s in sellers %}
                    <tr>
                        <td>{{ s.email }}</td>
                        <td>{{ s.count }} —à—Ç.</td>
                        <td>{{ s.total }} ‚ÇΩ</td>
                        <td><a href="/seller_history/{{ s.email }}">üìú –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
</body>
</html>
